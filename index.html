<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Gif Heaven</title>
        <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<link rel="stylesheet" type="text/css" href="assets/css/style.css">
    </head>
    <body>
    	<div id="bg">
	    	<div id="title">
	    		<form>
		    		<label for="textAnimalName">Add an Animal</label>
		    		<input type="text" id="textAnimalName">
		    		<input type="submit" id="addBtn" value="submit">
		    	</form>
		    	<div id="animalBtns"></div>
	    	</div>


			<div id="bgImg">
			<br>
		    	<div id="animalResult"></div>
			</div>
		</div>

		<script>
			var buttons = ["cat", "dog", "bird"];

			$("#addBtn").on("click", function(event){
				console.log("submit btn clicked");
				event.preventDefault();
				var animalName = $("#textAnimalName").val();
				buttons.push(animalName);
				renderBtns();
			});

			function renderBtns(){
				console.log("rendering buttons");
				$("#animalBtns").empty();
				for (var i=0; i<buttons.length; i++){
					newBtn = $("<button>");
					newBtn.text(buttons[i]);
					newBtn.addClass("btn");
					$("#animalBtns").append(newBtn);
				}
			}

			$(document).on("click", ".btn", displayRequest);

			// $(".btn").on("click", function(){
			// 	console.log("animal btn clicked");
			// 	displayRequest();
			// })

			

			function displayRequest(){
				console.log("displaying request");
				$("#animalResult").empty();

				var animal = $(this).text();
				var queryURL = "https://api.giphy.com/v1/gifs/search";

				queryURL += "?" + $.param({
					"api_key": "1bafd13581464249a37388d6d55fe348",
					"q": animal,
					"limit": 10,
					"rating": "g",
				});

				$.ajax({
					url: queryURL,
					method: "GET",
				}).done(function(response){
					console.log(response.data);

					// response.data[i].images.fixed_height.url
					// response.data[i].images.fixed_height_still.url

					for (var i=0; i<response.data.length; i++){
						var newDiv = $("<div>");
						var newImg = $("<img>");
						// newDiv.html("<img src='" + response.data[i].images.fixed_height_still.url + "''>");
						newImg.attr({"data-state":"still", "src":response.data[i].images.fixed_width_still.url, "data-still":response.data[i].images.fixed_width_still.url, "data-animate":response.data[i].images.fixed_width.url});
						newImg.addClass("gif");

						newDiv.append(newImg);
						$("#animalResult").append(newDiv);
					}
				});
			}

			$(document).on("click", ".gif", function(){
				console.log("img clicked");
				if ($(this).attr("data-state") === "still"){
					console.log("still");
					$(this).attr("src", $(this).attr("data-animate"));
					$(this).attr("data-state", "animate");
				}
				else {
					console.log("animate");
					$(this).attr("src", $(this).attr("data-still"));
					$(this).attr("data-state", "still");
				}
			});

			

			renderBtns();
			
		</script>

    </body>
</html>

<!-- On the top of scree, there are lots of buttons with name of animals.
When you click it, 10 images will show up from gifty api.
When you click on image, video will start.
When you click it again, it stops.

User can also add a button form the input.
 -->